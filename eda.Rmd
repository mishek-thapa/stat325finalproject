---
title: "dataexploration"
output: pdf_document
---

```{r}
knitr::opts_chunk$set(message = FALSE, echo = FALSE, warning=FALSE)
```

```{r}
library(tidyverse)
library(GGally)
library(ggplot2)
library(gridExtra)
```

```{r}
mydata <- read_csv("covid.csv")
```


```{r}
mydata %>%
  ggplot(aes(x = increaseRate, y = death_rate_log)) +
  geom_point()

pairs(data = mydata, ~ log(increaseRate) +(death_rate) + log(population) + log(popChange))
pairs(data = mydata, ~increaseRate + death_rate + population + popChange)
pairs(data = mydata, ~increaseRate + death_rate + population + popChange)

```

```{r echo=FALSE, fig.align='center', out.width = "240px", fig.cap="Correlation plot of county population statistics"}
ggcorr(mydata[,c("netMigrationRate", "domMigrationRate", "increaseRate", "deathRate", "birthRate", "popChange", "population")],  label = TRUE, layout.exp = 0)
```

```{r echo=FALSE, fig.align='center', out.width = "70%", fig.cap="Pairs plot illustrating relationship between pro-Trump vote share and a county's domestic migration rate and natural increase rate. Grouped by U.S. region."}
ggpairs(mydata[,c("domMigrationRate", "increaseRate", "proTrump")], 
        ggplot2::aes(color= mydata$region, alpha = .3),
        diag = list(discrete="barDiag"))
```

```{r echo=FALSE, warning = FALSE, fig.align='center', out.width = "85%", fig.cap="Bar-charts illustrating general relationship between pro-Trump vote share in 2016 and various categorical predictors, as well as between USDA metro/non-metro qualifiers and county population"}
h1 <- ggplot(legend = 0, mydata, aes(x=region, y=proTrump, fill = region)) + stat_summary(fun.y="mean", geom="bar") + theme(legend.position="none") + labs(x = "Region", y = "Trump Vote Share")
h2 <- ggplot(legend = 0, mydata, aes(x=main_econ, y=proTrump, fill = main_econ)) + stat_summary(fun.y="mean", geom="bar") + theme(axis.text.x = element_text(vjust = grid::unit(c(-2, 0, 2), "points")), legend.position="none") + labs(x = "\n\nPrimary Economy", y = "Trump Vote Share")
h3 <- ggplot(legend = 0, mydata, aes(x=metro_area, y=proTrump, fill = metro_area)) + stat_summary(fun.y="mean", geom="bar") + theme(legend.position="none") + labs(x = "Rural/Urban Code", y = "TrumpVote Share")
h4 <- ggplot(legend = 0, mydata, aes(x=metro_area, y=population, fill = metro_area)) + stat_summary(fun.y="mean", geom="bar") + theme(legend.position="none") + labs(x = "Rural/Urban Code", y = "Population")
g <- grid.arrange(h1, h2, h3, h4)
```

```{r echo=FALSE, message = FALSE, fig.align='center', out.width = "240px", fig.cap="Distribution of weekly cases during Week 25 (July 6 - July 12, 2020)"}
mydata%>%
  ggplot(aes(x = casecount)) + geom_histogram() + labs(x = "Total County-Level Cases", y = "Count")
```

```{r echo=FALSE, message = FALSE, fig.align='center', out.width = "240px", fig.cap="Distribution of weekly cases during Week 25 (July 6 - July 12, 2020)"}
mydata%>%
  ggplot(aes(x = deathcount)) + geom_histogram() + labs(x = "Total County-Level Cases", y = "Count")
```

```{r echo=FALSE, message = FALSE, fig.align='center', out.width = "240px", fig.cap="Distribution of weekly cases during Week 25 (July 6 - July 12, 2020)"}
mydata%>%
  ggplot(aes(x = death_rate)) + geom_histogram() + labs(x = "Total County-Level Cases", y = "Count")
```

```{r echo=FALSE, message = FALSE, fig.align='center', out.width = "240px", fig.cap="Distribution of weekly cases during Week 25 (July 6 - July 12, 2020)"}
mydata%>%
  ggplot(aes(x = death_rate_log)) + geom_histogram() + labs(x = "Total County-Level Cases", y = "Count")
```